import{_ as L}from"./Csz6-sdz.js";import{u as N,_ as R}from"./CNf1FbPc.js";import{_ as T}from"./C1bY634J.js";import{P as j}from"./BMHaNUcL.js";import{g as E,u as I,h as U,s as P,r as b,i as V,j as m,k as $,l as g,m as n,P as M,n as z,o as _}from"./Pd6RrLp1.js";import{u as H}from"./5Tbs7Tph.js";import"./DDeKuuea.js";import"./qKLLgZOX.js";import"./B-l2-lBV.js";import"./BRd7Y3HP.js";import"./BdleNovN.js";import"./DrybQeLc.js";import"./Cuh519_O.js";import"./C3MdYnyV.js";import"./DV533Gpo.js";import"./DcmtLR2x.js";import"./B4ouTiC0.js";import"./UMgXyzVE.js";import"./CcjC4gLZ.js";import"./DqO2dBIS.js";import"./CuRHY0aD.js";const J={class:"conditions-page_slider"},K={key:0},O={key:1},ht={__name:"trade-in",setup(Q){const C=E().$i18n,D=I(),{fetchConstructorPayload:S}=N(),{bannersGroup:w,bannersSpeed:B,fetchBannerGroup:x}=H(),{addCatalogDevice:k,catalogDevices:f,getCatalogDeviceFromLC:q,addCatalogDeviceToLC:A}=U(),i=P(null),p=P(null),y=b(!1),h=b([]),F=async()=>{var o;try{const t=await M.getAggregatePageBySlug("trade-in");i.value=(o=t==null?void 0:t.data)==null?void 0:o.data,p.value=await S(i.value.blocks),await x(z.subcategoryBanner);const r=w.value.find(a=>a.name==="trade-in");r&&(h.value=[r]),y.value=!0}catch(t){console.error(t)}},G=async()=>{const o=q(),t=D.query.product,r=f.value.length===0&&o.length>f.value.length;if(t||r){const a=[];t&&typeof t=="string"&&a.push(t),o.forEach(({product:e})=>{a.push(e.slug)});const{data:u}=await j.getProducts({lang:C.locale,searchFields:"slug:in",limit:9999,search:`slug:${a.join(",")}`}),v=o.map(e=>{const s=u.data.find(d=>+d.id==+e.product.id);return s&&(s.id=String(s.id)),{...e,product:s}}),c=u.data.find(e=>e.slug===t);if(t&&c){const e=c.category_branch.find(l=>l.parent_id===null),s=c.category_branch.find(l=>l.parent_id===e.id),d={id:new Date().getTime().toString(36),form:{category:e,subcategory:s,notRequiredFilters:!0,product:c},product:c};v.push(d),A(d)}k(v)}};return V(async()=>{await F(),await G()}),(o,t)=>{const r=L,a=R,u=T;return _(),m("div",null,[$("div",J,[g(r,{slides:n(h),frequency:n(B)||5e3,"is-loaded":n(y)},null,8,["slides","frequency","is-loaded"])]),n(i)&&n(p)?(_(),m("div",K,[g(a,{"page-data":n(i),payload:n(p)},null,8,["page-data","payload"])])):(_(),m("div",O,[g(u)]))])}}};export{ht as default};
