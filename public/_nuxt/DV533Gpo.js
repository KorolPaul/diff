import{a6 as u,a7 as h,a9 as p,au as e,aJ as _}from"./Pd6RrLp1.js";import{P as f}from"./DcmtLR2x.js";function v(t){return t==null?void 0:t.filter(n=>n.type!=="delivery")}const c=`${h}cart`,j=e.object({fixed:e.number().nullable(),percent:e.number().nullable(),type:e.number().nullable()}),P=e.object({availableQuantity:e.number(),bundlePairingCmsId:e.string().nullable(),bundlePairingProductId:e.string().nullable(),crmId:e.string(),deliveryDate:e.string().nullable(),details:e.object({name:e.string()}),discountDetails:j,id:e.number().nullable(),isNpiState:e.boolean(),isTradeIn:e.boolean().nullable(),name:e.object({[typeof _]:e.string()}),orderedQuantity:e.number(),packageCode:e.string().nullable(),photoUrl:e.string().nullable(),preorderDate:e.string().nullable(),price:e.number(),priceBundle:e.number(),priceCategory4:e.number(),priceCategory5:e.number(),priceWithDiscount:e.number(),productTypeId:e.number().nullable(),reservationQuantity:e.string().nullable(),sku:e.string(),taxNumber:e.string().nullable(),totalPrice:e.number(),totalPriceBundle:e.number(),totalPriceCategory4:e.number(),totalPriceCategory5:e.number(),totalPriceWithDiscount:e.number(),type:e.string(),vendorId:e.number().nullable()}),C=P.extend({bundlePairing:e.object({products:e.lazy(()=>C.array())})}),I=e.object({apartmentNumber:e.string().nullable(),city:e.string().nullable(),country:e.string().nullable(),floor:e.string().nullable(),houseNumber:e.string().nullable(),region:e.string().nullable(),street:e.string().nullable(),zipCode:e.string().nullable()}),T=e.object({email:e.string().nullable(),firstName:e.string().nullable(),isOtherReceiver:e.boolean(),lastName:e.string().nullable(),phone:e.string().nullable()}),S=e.object({address:I,group:e.string(),recipient:T,shopAddress:e.string().nullable(),type:e.string()}),k=e.object({addresses:e.array(e.object({address:e.object({id:e.number(),name:e.string()}),shop:e.object({id:e.number(),name:e.string()})})),configId:e.number(),cost:e.number(),currency:e.string(),enabled:e.boolean(),group:e.string(),isTradeIn:e.boolean(),name:e.string()}),$=e.object({configId:e.number(),creditParams:e.object({group:e.string(),isNested:e.boolean(),isTradeIn:e.boolean(),name:e.object({}),programs:e.array(e.object({bankCommissionPercent:e.number(),bankName:e.string(),consumerPercent:e.number(),id:e.number(),monthlyPercent:e.number(),name:e.string(),term:e.number()})),tooltip:e.array(e.string()).nullable(),type:e.number()}).nullable(),default:e.boolean(),enabled:e.boolean(),formId:e.string().nullable(),group:e.string().nullable(),id:e.number(),isOnlinePayment:e.boolean(),isTradeIn:e.boolean(),name:e.string(),partialPaymentAmounts:e.array(e.object({id:e.number(),default:e.boolean(),value:e.number()})).nullable(),type:e.string()}),D=e.object({deliveryTypes:e.array(k),paymentTypes:e.array($)}),N=e.object({creditProgramId:e.number().nullable(),currency:e.string(),form:e.object({fields:e.array(e.object({attributes:e.array(e.object({type:e.string(),value:e.string()})),name:e.string(),percentageWidth:e.number(),type:e.string(),validations:e.array(e.object({errorMessage:e.string(),rule:e.string(),value:e.string()}))})),values:e.null()}),group:e.string().nullable(),isOnlinePayment:e.boolean(),isPriceCategory4:e.boolean(),isPriceCategory5:e.boolean(),isUseBasePrice:e.boolean(),mainType:e.string(),partialPaymentAmount:e.string().nullable(),type:e.string()}),W=e.object({availableQuantity:e.number(),credit:e.object({monthlyPayment:e.number(),schedule:e.array(e.object({interestPayment:e.number(),month:e.number(),principalPayment:e.number(),remainingPrincipal:e.number(),totalPayment:e.number()})),totalAmountWithInterest:e.number(),totalAmountWithoutInterest:e.number()}),deliveryPrice:e.number(),featuredCredit:e.object({maxTerm:e.number(),minMonthlyPayment:e.number()}),orderedQuantity:e.number(),productCount:e.number(),totalPartialPrice:e.number(),totalPrice:e.number(),totalPriceWithDiscount:e.number(),totalPriceWithDiscountWithoutDelivery:e.number(),totalPriceWithoutDelivery:e.number(),totalTradeInGradePrice:e.number().nullable()}),x=e.object({crmId:e.string(),email:e.string().email(),lastname:e.string().nullable(),name:e.string(),phone:e.string().nullable(),uuid:e.string()});e.object({comment:e.string().nullable(),config:D,delivery:S,payment:N,products:e.array(P),token:e.string(),total:W,user:x});const d=t=>{const n=p("front-cart-token");n.value&&t("Cart-Token",n.value)},B={async getCart(){var l,r;const{get:t,setHeader:n}=u();d(n);const{data:i}=await t(`${c}`),a=(r=(l=i.value)==null?void 0:l.data)==null?void 0:r.cart,g=v((a==null?void 0:a.products)||[]),b=p("front-cart-token",{path:"/"});return b.value=a==null?void 0:a.token,{data:{data:{cart:{...a,products:g}}}}},async deleteAllProductFromCart(){const{remove:t,setHeader:n}=u();return d(n),t(`${c}/`)},async deleteProductFromCart(t,n=null,i=null){const{put:a,setHeader:g}=u(),b=p("front-cart-token");return b.value&&g("Cart-Token",b.value),a(`${c}/change`,{crm_id:t,available_quantity:0,bundle_pairing_cms_id:n,bundle_pairing_product_id:i})},async updateUserCart(t){const{patch:n,setHeader:i}=u();return d(i),n(`${c}/user`,t)},async changeCountProductFromCart(t,n,i=null,a=null){const{put:g,setHeader:b}=u();return d(b),g(`${c}/change`,{crm_id:t,available_quantity:n,bundle_pairing_cms_id:i,bundle_pairing_product_id:a})},async addProductToCart(t,n=1){const{post:i,setHeader:a}=u();return d(a),i(`${c}/add`,{available_quantity:n,product_id:t,product_type:"physical",loyalty_card_number:"29904263163"})},async addBundleToCart(t){const{post:n,setHeader:i}=u();return d(i),n(`${c}/bundle-pairing/add`,{quantity:1,id:`${t}`})},async replaceCart(t,n=null){const{post:i,setHeader:a}=u();return d(a),i(`${c}/replace`,{products:t,payment:n})}},F=()=>{const t=l=>{const r=[],s=[];return l.forEach(o=>{o.bundle_pairing&&o.bundle_pairing.products.forEach(m=>{s.push({crm_id:m.crm_id,bundle_pairing_cms_id:o.bundle_pairing_cms_id}),r.push(m)}),r.push(o)}),{productIds:r,bundles:s}},n=l=>`${l.map(r=>r.crm_id).join(",")},`,i=l=>({search:`crm_id:${n(l)}`,searchFields:"crm_id:in"}),a=(l,r)=>l==null?void 0:l.map(s=>{const o={...s},m=r.find(y=>{y.crm_id,s.crm_id});return m&&Object.assign(o,m),o});return{transformProductsIdsToString:n,fetchProducts:async l=>{var r;try{const{productIds:s,bundles:o}=t(l),m=i(s),y=await f.getProducts(m);return a((r=y==null?void 0:y.data)==null?void 0:r.data,o)}catch(s){return console.error(s),[]}},extractProductNames:l=>l.map(r=>{var s;return{...r,name:(s=r==null?void 0:r.details)==null?void 0:s.name}})}};export{B as C,x as a,P as b,$ as c,v as f,N as p,d as s,W as t,F as u};
