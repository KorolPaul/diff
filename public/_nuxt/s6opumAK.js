import F from"./UDYLtqhF.js";import{_ as P,d as B,r as i,i as w,j as s,F as y,L as R,o as n,k as v,c as $,t as A,l as k,z as C,g as D,G as N,u as I,x as T,q as U,w as V,y as _,O as j,B as g,A as G}from"./Pd6RrLp1.js";import{_ as L}from"./CuRHY0aD.js";import{_ as q}from"./DlfIw6Ms.js";import{u as z}from"./B64m7KbU.js";import{C as E}from"./BslN7nPp.js";import{s as O}from"./km7Iw1uL.js";import"./UMgXyzVE.js";import"./CcjC4gLZ.js";import"./C3MdYnyV.js";import"./DV533Gpo.js";import"./DcmtLR2x.js";import"./B4ouTiC0.js";const S=B({name:"CheckoutPaymentRedirectForm",props:{payment:{type:Object,required:!0}},setup(){const e=i(null);return w(()=>{e.value.submit()}),{paymentForm:e}}}),M=["method","action"],H=["name","value"];function J(e,f,h,t,u,l){return n(),s("form",{ref:"paymentForm",method:e.payment.method,action:e.payment.url},[(n(!0),s(y,null,R(e.payment.form_data,(o,a)=>(n(),s("input",{key:o,type:"hidden",name:a,value:o},null,8,H))),128))],8,M)}const x=P(S,[["render",J]]),K={components:{CheckoutPaymentRedirectForm:x},setup(){const e=D(),{pushGtmEvent:f}=U(),{logoutIfUserUnregister:h}=z(),t=N(),u=I(),l=i(null),o=i(null),a=i(6),p=i(null),d=i(!1),c=T(()=>{var m,r;return(r=(m=o.value)==null?void 0:m.payment)==null?void 0:r.type}),b=()=>{clearInterval(p.value),!(!o.value||!c.value)&&(d.value=!0,c.value==="submit_form"&&(l.value=o.value.payment),c.value==="redirect"&&window.location.replace(o.value.payment.url))};return w(async()=>{var m;try{const r=await E.checkPayment(u.params.id);o.value=(m=r==null?void 0:r.data)==null?void 0:m.data,o.value.payment!==null?p.value=O(()=>{a.value-=1},1e3):t.push(e.$localeRoute({path:`/checkout/${u.params.id}?type=success`}))}catch(r){console.log(r)}finally{h()}f("pageview",{page:document.title,path:window.location.path})}),V(a,()=>{a.value||b()}),{counter:a,paymentType:c,submitPaymentForm:l,goToPaymentPage:b,isButtonDisabled:d,resData:o}}},Q={class:"redirect-wrapper"},W={key:0,class:"redirect-inner"},X={class:"text-subtitle-1 mb-4"};function Y(e,f,h,t,u,l){const o=F,a=G,p=L,d=q,c=x;return n(),s(y,null,[v("div",Q,[k(d,{class:"d-flex justify-center"},{default:C(()=>[t.counter<=5?(n(),s("div",W,[k(o,{class:"redirect-logo"}),v("span",X,_(e.$t("transition_to_payment")),1),v("span",{class:j(["text-body-2 mb-7 gray--text gray--darken-1",{"text--darken-5":!t.counter}])},[t.counter&&!t.isButtonDisabled?(n(),s(y,{key:0},[g(_(`${e.$t("redirect_in")} ${t.counter} ${e.$t("seconds")}`),1)],64)):(n(),s(y,{key:1},[g(_(`${e.$t("redirecting")}...`),1)],64))],2),k(a,{disabled:!t.counter||t.isButtonDisabled,"full-width":"",onClick:t.goToPaymentPage},{default:C(()=>[g(_(e.$t("go_to_payment")),1)]),_:1},8,["disabled","onClick"])])):(n(),$(p,{key:1}))]),_:1})]),t.submitPaymentForm?(n(),$(c,{key:0,payment:t.submitPaymentForm},null,8,["payment"])):A("",!0)],64)}const pe=P(K,[["render",Y],["__scopeId","data-v-e9ffac8b"]]);export{pe as default};
